import random

# =========================
# ì„ ìˆ˜ í´ë˜ìŠ¤
# =========================

class Batter:
    def __init__(self, name, contact, power, speed):
        self.name = name
        self.contact = contact  # 1~10
        self.power = power
        self.speed = speed

class Pitcher:
    def __init__(self, name, control, stuff, stamina):
        self.name = name
        self.control = control  # 1~10
        self.stuff = stuff
        self.stamina = stamina
        self.max_stamina = stamina

# =========================
# íŒ€ í´ë˜ìŠ¤
# =========================

class Team:
    def __init__(self, name, batters, pitchers):
        self.name = name
        self.batters = batters
        self.pitchers = pitchers
        self.score = 0
        self.current_pitcher_index = 0

    @property
    def pitcher(self):
        return self.pitchers[self.current_pitcher_index]

    def change_pitcher(self):
        if self.current_pitcher_index + 1 < len(self.pitchers):
            self.current_pitcher_index += 1
            print(f"ğŸ”„ íˆ¬ìˆ˜ êµì²´! â†’ {self.pitcher.name}")
        else:
            print("âŒ ë” ì´ìƒ êµì²´í•  íˆ¬ìˆ˜ê°€ ì—†ë‹¤!")

# =========================
# íƒ€ì„ ë¡œì§
# =========================

def at_bat(batter, pitcher):
    stamina_penalty = max(0, pitcher.max_stamina - pitcher.stamina)

    hit_chance = (
        batter.contact * 10
        - pitcher.control * 5
        + random.randint(-10, 10)
        + stamina_penalty * 3
    )

    pitcher.stamina -= 1
    roll = random.randint(1, 100)

    if roll <= hit_chance:
        power_roll = random.randint(1, 10)
        if power_roll <= batter.power:
            return "HR"
        elif power_roll <= batter.power + 2:
            return "2B"
        else:
            return "1B"
    else:
        return "OUT"

# =========================
# ë„ë£¨ ë¡œì§
# =========================

def steal_attempt(batter, pitcher):
    chance = batter.speed * 10 - pitcher.control * 5
    roll = random.randint(1, 100)
    return roll <= chance

# =========================
# ì£¼ì ì´ë™
# =========================

def advance_runners(bases, hit):
    runs = 0

    if hit == "HR":
        runs = sum(bases) + 1
        bases = [0, 0, 0]

    elif hit == "2B":
        runs += bases[2] + bases[1]
        bases = [0, 1, bases[0]]

    elif hit == "1B":
        runs += bases[2]
        bases = [1, bases[0], bases[1]]

    return bases, runs

# =========================
# ë°˜ ì´ë‹
# =========================

def play_half_inning(offense, defense):
    outs = 0
    batter_index = 0
    bases = [0, 0, 0]

    while outs < 3:
        pitcher = defense.pitcher
        batter = offense.batters[batter_index % len(offense.batters)]

        print(f"\níˆ¬ìˆ˜: {pitcher.name} (ì²´ë ¥ {pitcher.stamina}/{pitcher.max_stamina})")
        print(f"ì£¼ì: 1ë£¨[{bases[0]}] 2ë£¨[{bases[1]}] 3ë£¨[{bases[2]}]")

        # --- ê°ë… ì„ íƒ ---
        if bases[0] == 1:
            cmd = input("ì§€ì‹œ: [Enter] íƒ€ê²© / s ë„ë£¨ : ")
            if cmd == "s":
                success = steal_attempt(batter, pitcher)
                if success:
                    print("ğŸƒ ë„ë£¨ ì„±ê³µ!")
                    bases[0], bases[1] = 0, 1
                else:
                    print("âŒ ë„ë£¨ ì‹¤íŒ¨! ì•„ì›ƒ")
                    outs += 1
                    bases[0] = 0
                    continue

        result = at_bat(batter, pitcher)
        print(f"{batter.name} â†’ {result}")

        if result == "OUT":
            outs += 1
        else:
            bases, runs = advance_runners(bases, result)
            offense.score += runs
            if runs:
                print(f"ğŸ’° {runs}ì  ë“ì !")

        if pitcher.stamina <= 2:
            change = input("âš ï¸ íˆ¬ìˆ˜ ì²´ë ¥ ë¶€ì¡±! êµì²´? (y/n): ")
            if change == "y":
                defense.change_pitcher()

        batter_index += 1

# =========================
# ê²½ê¸° ì§„í–‰
# =========================

def play_game(team1, team2):
    print(f"\nâš¾ {team1.name} vs {team2.name} ê²½ê¸° ì‹œì‘!")

    for inning in range(1, 10):
        print(f"\n=== {inning}íšŒ ì´ˆ ({team1.name}) ===")
        play_half_inning(team1, team2)

        print(f"\n=== {inning}íšŒ ë§ ({team2.name}) ===")
        play_half_inning(team2, team1)

    print("\n=== ê²½ê¸° ì¢…ë£Œ ===")
    print(f"{team1.name} {team1.score} : {team2.score} {team2.name}")

# =========================
# íŒ€ ì„¤ì •
# =========================

my_team = Team(
    "ë‚´ êµ¬ë‹¨",
    batters=[
        Batter("íƒ€ì1", 7, 5, 7),
        Batter("íƒ€ì2", 6, 6, 5),
        Batter("íƒ€ì3", 8, 7, 4),
    ],
    pitchers=[
        Pitcher("ì„ ë°œ", 7, 6, 8),
        Pitcher("ë¶ˆíœ1", 6, 6, 5),
        Pitcher("ë¶ˆíœ2", 5, 5, 4),
    ]
)

npc_team = Team(
    "NPC êµ¬ë‹¨",
    batters=[
        Batter("NPC1", 5, 5, 5),
        Batter("NPC2", 6, 4, 6),
        Batter("NPC3", 7, 6, 4),
    ],
    pitchers=[
        Pitcher("NPCì„ ë°œ", 6, 5, 7),
        Pitcher("NPCë¶ˆíœ", 5, 5, 5),
    ]
)

play_game(my_team, npc_team)
